<!-- Guardar el ID del usuario en localStorage -->
<script th:inline="javascript">
    /*<![CDATA[*/
    const idUsuario = /*[[${session.usuario.idusuario}]]*/ '0';
    localStorage.setItem("idUsuario", idUsuario);
    console.log("ðŸ§ª ID usuario guardado en localStorage:", idUsuario);
    /*]]>*/
</script>

<!-- Dialogflow Messenger -->
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
        id="chatbot"
        intent="WELCOME"
        chat-title="ReservaSanMiguelBot"
        agent-id="86beb279-f2f8-4833-a2a5-62510565b625"
        language-code="es">
</df-messenger>

<!-- Setear el user-id despuÃ©s de cargar el componente -->
<script>
    window.addEventListener('dfMessengerLoaded', function () {
        const idUsuario = localStorage.getItem("idUsuario") || "0";
        const dfMessengerEl = document.querySelector('df-messenger');
        if (dfMessengerEl) {
            dfMessengerEl.setAttribute('user-id', idUsuario);
            console.log("âœ… user-id seteado desde localStorage:", idUsuario);
        }
    });
</script>
